# 闲鱼智能监控机器人 (AI Price Monitor)

基于 Playwright 和 AI 的闲鱼多任务实时监控工具，提供完整的 Web 管理界面。
专为捡漏设计，支持**秒级监控**、**AI 智能识图**、**多渠道通知**。

## ✨ 核心特性

*   **🧠 AI 智能大脑**: 
    *   接入 **Gemini 3.0 Flash** (速度快、识图准、成本低)。
    *   **智能识图**: 自动识别屏幕划痕、磕碰、配件缺失，比人眼更毒。
    *   **语义分析**: 懂“无划痕”是好话，懂“仅面交”是坏话，不再机械匹配。
*   **🖥️ Web 可视化管理**: 
    *   无需写代码，直接在网页上添加/修改监控任务。
    *   查看实时日志、监控结果、AI 分析报告。
*   **⚡ 高效捡漏**: 
    *   **秒级响应**: 发现新商品 -> AI 分析 -> 推送通知，全程仅需几秒。
    *   **防误杀**: 针对低价商品（如年会奖品、急出回血）有特殊豁免逻辑，不会因为“价格太低”而错过神价。
*   **🔔 多渠道通知**: 
    *   支持 **飞书 (Feishu)**、企业微信、Telegram、Bark 等。
    *   通知包含：商品图、价格、AI 评价（推荐理由/风险点）、直达链接。
*   **🛡️ 反爬与稳定**: 
    *   支持多账号/代理轮换。
    *   智能频率控制（推荐 15分钟/次），兼顾时效与安全。

---

## 🚀 极速上手 (Windows)

本项目已为 Windows 用户深度优化，提供**一键脚本**，无需懂代码即可运行。

### 1. 📂 目录结构说明
下载并解压后，你只需要关注以下几个核心文件：

*   **`Start_App.bat`**: 🚀 **一键启动**（双击这个就能跑）
*   **`Stop_App.bat`**: 🛑 **一键停止**（双击这个就关闭）
*   **`Upload_GitHub.bat`**: ☁️ **一键备份**（把配置和代码同步到 GitHub）
*   **`.env`**: ⚙️ **系统配置文件**（改 Key、改通知地址、改代理）
*   **`config.json`**: 📋 **监控任务列表**（改关键词、价格区间、扫描频率）

### 2. ⚙️ 配置指南

#### 第一步：系统配置 (`.env`)
用记事本打开 `.env` 文件，修改以下关键项：

```ini
# --- AI 配置 (推荐使用 Gemini 3.0 Flash) ---
OPENAI_API_KEY=sk-xxxxxxxxxxxxxxxxxxxxxxxx  # 你的 API Key
OPENAI_BASE_URL=https://api.gemai.cc/v1/    # API 接口地址
OPENAI_MODEL_NAME=[福利]gemini-3-flash-preview  # 模型名称

# --- 通知配置 (以飞书为例) ---
WEBHOOK_URL=https://open.feishu.cn/open-apis/bot/v2/hook/xxxx-xxxx  # 飞书机器人 Webhook

# --- 网络配置 ---
PROXY_URL="http://127.0.0.1:7897"  # 如果你需要代理才能访问外网，填这个
```

#### 第二步：添加监控任务 (`config.json`)
用记事本打开 `config.json`，参考以下模板添加你想监控的商品：

```json
[
  {
    "task_name": "OPPO Find X8 捡漏王",
    "keyword": "OPPO Find X8 16 512",
    "min_price": "1000",
    "max_price": "2400",
    "cron": "*/15 * * * *",  // 推荐：每15分钟运行一次
    "description": "拒绝'有划痕'、'屏幕碎'；保留'无划痕'、'年会奖品'。",
    "enabled": true
  }
]
```

### 3. ▶️ 启动运行
1.  双击 **`Start_App.bat`**。
2.  会自动弹出两个黑色窗口（一个是后台，一个是网页）。
3.  打开浏览器访问：[http://localhost:5173](http://localhost:5173)
4.  开始捡漏！💰

---

## 🛠️ 进阶技巧

### 1. 如何调整 AI 的判断标准？
如果你发现 AI 总是看走眼，或者太严格，可以修改 `prompts/` 目录下的 `.txt` 文件。
例如 `prompts/oppo_find_x8_16_512_criteria.txt`，用自然语言告诉 AI：
> "不要在意包装盒是否有压痕，只要手机本体没问题就行。"

### 2. 扫描频率设置多少合适？
推荐 **15分钟一次** (`*/15 * * * *`)。
*   **太快 (如 1分钟)**: 容易被闲鱼封号（反爬虫）。
*   **太慢 (如 1小时)**: 好东西早被别人抢走了。
*   **费用**: 不用担心，只有**发现新商品**时才会调用 AI 扣费，空跑是不花钱的。

---

## 🤝 贡献与致谢
本项目基于 [Usagi-org/ai-goofish-monitor](https://github.com/Usagi-org/ai-goofish-monitor) 二次开发，感谢原作者及 LinuxDo 社区的贡献。

**Enjoy your hunting!** 📱✨
